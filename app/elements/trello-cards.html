<!--
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="trello-checklist.html">
<link rel="import" href="trello-comments.html">

<dom-module id="trello-cards">

  <style>
    :host {
      font-family: 'Muli', 'Helvetica Neue', helvetica, arial;
      display: block;
    }
    .pic {
      width: 350px;
      height: auto;
    }
    .container {
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
    }
    .red {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   red;
      margin-left: 2px;
      margin-right: 2px;
    }
    .green {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   green;
      margin-left: 2px;
      margin-right: 2px;
    }
    .yellow {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   yellow;
      margin-left: 2px;
      margin-right: 2px;
    }
    .orange {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   orange;
      margin-left: 2px;
      margin-right: 2px;
    }
    .purple {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   purple;
      margin-left: 2px;
      margin-right: 2px;
    }
    .blue {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   blue;
      margin-left: 2px;
      margin-right: 2px;
    }
    .lime {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   lime;
      margin-left: 2px;
      margin-right: 2px;
    }
    .pink {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   pink;
      margin-left: 2px;
      margin-right: 2px;
    }
    .black {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   black;
      margin-left: 2px;
      margin-right: 2px;
    }
    .sky {
      padding: 2px;
      display: inline-block;
      min-width: 50px;
      height:  20px;
      border-radius:  4px;
      background-color:   lightblue;
      margin-left: 2px;
      margin-right: 2px;
    }
  </style>

  <template>

    <template is="dom-repeat" items="{{cards}}" filter="{{_filter(list)}}">
      <h2>{{item.name}}</h2>
        <div class="container">
          <template is="dom-repeat" items="{{item.labels}}">
            <div class$="{{item.color}}">{{item.name}}</div>
          </template>
        </div>
        <br>
      <div>
      <template is="dom-repeat" items="{{item.attachments}}">
        <img class="pic" src="{{item.url}}">
      </template>
      </div>

      <h3>{{item.desc}}</h3>

      <template is="dom-if" if="{{item.due}}">
        <span>Data de entrega: </span><span>{{item.due}}</span>
      </template>

      <trello-checklist checklists="{{checklists}}" card="{{item.id}}"></trello-checklist>
      <br>

      <template is="dom-if" if="{{item.badges.comments}}">
       	<h4>Comentários</h4>
    	</template>

      <trello-comments comments="{{comments}}" card="{{item.id}}"></trello-comments>

    </template>

  </template>

  <script>
    Polymer({

      is: 'trello-cards',

      properties: {
       cards: {
          type: Array
        },
       checklists: {
          type: Array
       },
       comments: {
          type: Array
       },
        list: {},
      },

      // Retorna somente as listas que não estão arquivadas 
      // Filtra o cartão pertencente a sua lista origem
      _filter: function(val1) {  
        return function(person) {
          return (person.idList && ~person.idList.indexOf(val1) && !person.closed);
        };
      }

    });
  </script>

</dom-module>